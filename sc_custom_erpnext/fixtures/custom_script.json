[
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Customer", 
  "modified": "2018-07-09 12:56:07.078326", 
  "name": "Customer-Client", 
  "script": "frappe.ui.form.on(\"Customer\", \"refresh\", function(frm) {\n\tfrm.add_custom_button(__('Consignment Stock Ledger'), function() {\n\t\t\t\tfrappe.set_route('query-report', 'Consignment Stock Ledger', {customer:frm.doc.name});\n\t});\n\tfrm.add_custom_button(__('Consignment Stock Balance'), function() {\n\t\t\t\tfrappe.set_route('query-report', 'Consignment Stock Balance', {customer:frm.doc.name});\n\t});\n\tdashboard_link_doctype(frm, \"Consignment Stock Entry\");\n});\n\n\ndashboard_link_doctype = function (frm, doctype){\n\n\tvar parent = $('.form-dashboard-wrapper [data-doctype=\"Sales Invoice\"]').closest('div').parent();\n\t\n\tparent.find('[data-doctype=\"'+doctype+'\"]').remove();\n\n\tparent.append(frappe.render_template(\"dashboard_link_doctype\", {doctype:doctype}));\n\n\tvar self = parent.find('[data-doctype=\"'+doctype+'\"]');\n\n\tset_open_count(frm, doctype);\n\n\t// bind links\n\tself.find(\".badge-link\").on('click', function() {\n\t\tfrappe.route_options = {\"customer\": frm.doc.name}\n\t\tfrappe.set_route(\"List\", doctype);\n\t});\n\n\t// bind open notifications\n\tself.find('.open-notification').on('click', function() {\n\t\tfrappe.route_options = {\n\t\t\t\"customer\": frm.doc.name,\n\t\t\t\"status\": \"Draft\"\n\t\t}\n\t\tfrappe.set_route(\"List\", doctype);\n\t});\n\n\t// bind new\n\tif(frappe.model.can_create(doctype)) {\n\t\tself.find('.btn-new').removeClass('hidden');\n\t}\n\tself.find('.btn-new').on('click', function() {\n\t\tfrappe.new_doc(doctype,{\n\t\t\t\"customer\": frm.doc.name\n\t\t});\n\t});\n}\n\nset_open_count = function (frm, doctype){\n\tfrappe.call({\n\t\tmethod: 'sc_custom_erpnext.sc_custom_erpnext.doctype.consignment_stock_entry.consignment_stock_entry.get_open_count',\n\t\targs: {customer:frm.doc.name},\n\t\tcallback: function(r) {\n\t\t\tfrm.dashboard.set_badge_count(\"Consignment Stock Entry\", r.message.open_count, r.message.total_count);\n\t\t}\n\t})\n}\n\nfrappe.templates[\"dashboard_link_doctype\"] = ' \\\n\t<div class=\"document-link\" data-doctype=\"{{ doctype }}\"> \\\n\t\t<a class=\"badge-link small\">{{ __(doctype) }}</a> \\\n\t\t<span class=\"text-muted small count\"></span> \\\n\t\t<span class=\"open-notification hidden\" title=\"{{ __(\"Open {0}\", [__(doctype)])}}\"></span> \\\n\t\t<button class=\"btn btn-new btn-default btn-xs hidden\" data-doctype=\"{{ doctype }}\"> \\\n\t\t\t\t<i class=\"octicon octicon-plus\" style=\"font-size: 12px;\"></i> \\\n\t\t</button>\\\n\t</div>';", 
  "script_type": "Client"
 }
]